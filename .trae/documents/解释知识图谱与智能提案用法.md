## 你现在看到的“这个功能”是哪块
- 你打开的是 [KnowledgeGraph.tsx](file:///d:/Demo/memflow/src/components/KnowledgeGraph.tsx)（知识图谱页）。它和右上角闪电图标的“智能提案”是两块不同功能。

## 功能说明（知识图谱）
- 目标：把你录制到的桌面活动（应用名、时间、OCR 文本）抽成一个“关系图”。
- 当前实现的节点/边：
  - 节点：应用(app)、时间段(time，按小时)、文档关键词(doc，来自 OCR 文本的简单关键词抽取)
  - 边：应用→时间段（occurs_at，表示该应用在该时段出现过）、应用→关键词（contains，表示 OCR 中出现过该关键词）
- 数据来源与生成方式：
  - 点击“重建图谱”会调用后端 [rebuild_graph](file:///d:/Demo/memflow/src-tauri/src/commands.rs#L257-L280)，它会从最近最多 1000 条活动里构建图谱 [build_graph](file:///d:/Demo/memflow/src-tauri/src/graph.rs#L36-L50)，并存入数据库 knowledge_nodes/knowledge_edges。
  - 页面加载时会调用 [get_graph_data](file:///d:/Demo/memflow/src-tauri/src/commands.rs#L257-L260) 读取已保存的图谱数据并展示。

## 怎么测试（知识图谱）
1. 在主界面点击“开始录制”。
2. 随便做一些操作（切换几个应用窗口、打开几个网页/文档），产生至少几十条活动。
3. 进入“知识图谱”页：
   - 若提示“暂无图谱数据”，点击右上角“重建图谱”。
4. 期望现象：
   - 出现 app/time/doc 三种颜色节点，节点越大表示出现越频繁。
   - 有连线：应用节点会连到时间节点；若 OCR 有内容，还会连到关键词节点。
5. 常见看不到 doc 节点的原因：
   - 录制时没有 OCR 文本（设置里可能关闭 OCR，或 OCR 还没跑完），那么只会有 app/time。

## 补充：智能提案是干什么的（右上角闪电）
- 目标：基于最近活动生成“可执行步骤”（当前 MVP 主要是“生成活动摘要并复制到剪贴板”）。
- 你点“执行”后会立刻生成一条执行记录（status=running），后台执行完成后变为 success/failed/cancelled，并在“执行历史”里可见（弹窗的 Tab）。
- 执行结果怎么验证：
  - copy_to_clipboard：去任意输入框粘贴，应能粘出摘要文本。
  - create_note：会在 Documents 目录追加写入 memflow_notes.md。

## 我建议的下一步（需要你确认后我再动代码）
1. 在“知识图谱”页新增一段简短使用说明（为什么要先录制、为什么要点重建、OCR 影响什么）。
2. 给“重建图谱”加进度/结果提示（节点数/边数），失败时给出更明确的错误。
3. 给“智能提案”执行后提供“已复制到剪贴板/已写入笔记”的明确反馈（基于执行 metadata）。